name: Install python and run a test

on:
  push:
  schedule:
      - cron: '51 0 * * *'

env:
  CFBD_API_KEY: ${{ secrets.CFBD_API_KEY }}

jobs:
  build:

    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v3
      - name: Set up Python 3.x
        uses: actions/setup-python@v3
        with:
          # Semantic version range syntax or exact version of a Python version
          python-version: '3.x'
      # You can test your matrix by printing the current Python version
      - name: Display Python version
        run: python -c "import sys; print(sys.version)"
      - name: Install dependencies
        run: python -m pip install --upgrade pip cfbd
      - name: Run the code
        run: python vconf/mcc_schedule.py -s 1970 -e 2000 > output.txt
      - name: md5_results
        run: /usr/bin/md5sum output.txt
      - name: Check md5
        id: check_md5
        run: echo "::set-output name=md5_out::"`/usr/bin/md5sum output.txt`
      - name: Pass or fail
        run: |
          if [[ "${{ steps.check_md5.outputs.md5_out }}" == "7de220da82eb846c3c806e06f5da209a output.txt" ]]; then exit 0; else exit 1; fi
